(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d14fc72"],{"3b6a":function(t,e,a){"use strict";a("a481"),a("6762"),a("2fdb");var o=a("2b0e");o["default"].directive("dialogDrag",{bind:function(t,e,a,o){var n=t.querySelector(".el-dialog__header"),i=t.querySelector(".el-dialog");n.style.cssText+=";cursor:move;",i.style.cssText+=";top:0px;";var l=function(){return window.document.currentStyle?function(t,e){return t.currentStyle[e]}:function(t,e){return getComputedStyle(t,!1)[e]}}();n.onmousedown=function(t){var e=t.clientX-n.offsetLeft,a=t.clientY-n.offsetTop,o=document.body.clientWidth,r=document.documentElement.clientHeight,s=i.offsetWidth,c=i.offsetHeight,u=i.offsetLeft,d=o-i.offsetLeft-s,p=i.offsetTop,m=r-i.offsetTop-c,f=l(i,"left"),b=l(i,"top");f.includes("%")?(f=+document.body.clientWidth*(+f.replace(/\%/g,"")/100),b=+document.body.clientHeight*(+b.replace(/\%/g,"")/100)):(f=+f.replace(/\px/g,""),b=+b.replace(/\px/g,"")),document.onmousemove=function(t){var o=t.clientX-e,n=t.clientY-a;-o>u?o=-u:o>d&&(o=d),-n>p?n=-p:n>m&&(n=m),i.style.cssText+=";left:".concat(o+f,"px;top:").concat(n+b,"px;")},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null}}}})},"531f":function(t,e,a){"use strict";a.d(e,"f",(function(){return i})),a.d(e,"g",(function(){return l})),a.d(e,"e",(function(){return r})),a.d(e,"h",(function(){return s})),a.d(e,"a",(function(){return c})),a.d(e,"c",(function(){return u})),a.d(e,"d",(function(){return d})),a.d(e,"b",(function(){return p}));var o=a("b775"),n=a("9a6f");function i(){return Object(o["a"])({url:n["a"].websiteConfig,method:"get"})}function l(t){return Object(o["a"])({url:n["a"].websiteConfig,method:"post",data:t})}function r(t){return Object(o["a"])({url:n["a"].jobList,method:"get",params:t})}function s(t){return Object(o["a"])({url:n["a"].jobList,method:"put",data:t})}function c(t){return Object(o["a"])({url:n["a"].jobList,method:"post",data:t})}function u(t){return Object(o["a"])({url:n["a"].jobList,method:"DELETE",params:t})}function d(t){return Object(o["a"])({url:n["a"].jobLogList,method:"get",params:t})}function p(t){return Object(o["a"])({url:n["a"].changeExecution,method:"post",data:t})}},"57d1":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"queryForm",attrs:{model:t.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"任务名称",prop:"roleName"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入任务名称",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleQuery(e)}},model:{value:t.queryParams.job_name,callback:function(e){t.$set(t.queryParams,"job_name",e)},expression:"queryParams.job_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"任务状态",clearableis_state:"",size:"small"},model:{value:t.queryParams.is_state,callback:function(e){t.$set(t.queryParams,"is_state",e)},expression:"queryParams.is_state"}},t._l(t.statusOptions,(function(t){return a("el-option",{key:t.dictValue,attrs:{label:t.dictLabel,value:t.dictValue}})})),1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:t.handleQuery}},[t._v("搜索")]),t._v(" "),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:t.resetQuery}},[t._v("重置")])],1)],1),t._v(" "),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:t.handleAdd}},[t._v("新增")])],1),t._v(" "),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"success",icon:"el-icon-edit",size:"mini",disabled:t.single},on:{click:t.handleUpdate}},[t._v("修改")])],1),t._v(" "),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",disabled:t.multiple},on:{click:t.handleDelete}},[t._v("删除")])],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tab_list},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"tab_id"}}),t._v(" "),a("el-table-column",{attrs:{label:"任务ID",prop:"id",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"任务名称",prop:"job_name",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"cron表达式",prop:"cron_expression",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"调用目标",prop:"invoke_target",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"执行状态",prop:"entry_id",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"任务状态",prop:"is_state",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createdAt",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.created_at))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-sort"},on:{click:function(a){return t.changeJobExecution(e.row)}}},[t._v("暂停/开启")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-document"},on:{click:function(a){return t.handleJobLog(e.row)}}},[t._v("日志")])]}}])})],1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],attrs:{total:t.total,page:t.queryParams.page,limit:t.queryParams.page_size},on:{"update:page":function(e){return t.$set(t.queryParams,"page",e)},"update:limit":function(e){return t.$set(t.queryParams,"page_size",e)},pagination:t.getList}}),t._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:t.title,visible:t.open,width:"700px"},on:{"update:visible":function(e){t.open=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[a("el-form-item",{staticStyle:{width:"50%",float:"left"},attrs:{prop:"job_name","label-width":"100px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v(" "),a("span",[t._v(" 任务名称 ")])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入任务名称"},model:{value:t.form.job_name,callback:function(e){t.$set(t.form,"job_name",e)},expression:"form.job_name"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"50%",float:"left"},attrs:{label:"任务分组",prop:"job_group","label-width":"100px"}},[a("el-input",{attrs:{placeholder:"请输入任务分组"},model:{value:t.form.job_group,callback:function(e){t.$set(t.form,"job_group",e)},expression:"form.job_group"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"100%",float:"left"},attrs:{prop:"invoke_target","label-width":"100px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v(" "),a("span",[t._v(" 调用目标 ")]),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"调用示例：func(t *Exec) PushParams(){...}, 填写pushParams 即可",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1)]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入调用目标"},model:{value:t.form.invoke_target,callback:function(e){t.$set(t.form,"invoke_target",e)},expression:"form.invoke_target"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"100%",float:"left"},attrs:{prop:"execution_policy","label-width":"100px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("span",[t._v(" 目标参数 ")]),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"传输给调用目标参数, 格式：text:123,key:value",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1)]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入调用目标"},model:{value:t.form.target_parameter,callback:function(e){t.$set(t.form,"target_parameter",e)},expression:"form.target_parameter"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"50%",float:"left"},attrs:{prop:"cron_expression","label-width":"100px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v(" "),a("span",[t._v(" cron表达式 ")])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入cron表达式"},model:{value:t.form.cron_expression,callback:function(e){t.$set(t.form,"cron_expression",e)},expression:"form.cron_expression"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"50%",float:"left"},attrs:{prop:"is_concurrent","label-width":"100px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("span",[t._v(" 是否并发 ")]),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"当任务执行时间大于设定下次时间，是否允许并发执行",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1)]),t._v(" "),a("el-radio-group",{model:{value:t.form.is_concurrent,callback:function(e){t.$set(t.form,"is_concurrent",e)},expression:"form.is_concurrent"}},[a("el-radio-button",{attrs:{label:"1"}},[t._v(" 允许 ")]),t._v(" "),a("el-radio-button",{attrs:{label:"0"}},[t._v(" 禁止 ")])],1)],1),t._v(" "),a("el-form-item",{staticStyle:{width:"100%",float:"left"},attrs:{prop:"invoke_type","label-width":"100px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("span",[t._v(" 调用类型 ")])])]),t._v(" "),a("el-radio-group",{model:{value:t.form.invoke_type,callback:function(e){t.$set(t.form,"invoke_type",e)},expression:"form.invoke_type"}},[a("el-radio-button",{attrs:{label:"interface"}},[t._v(" 接口 ")]),t._v(" "),a("el-radio-button",{attrs:{label:"function"}},[t._v(" 函数 ")])],1)],1),t._v(" "),a("el-form-item",{staticStyle:{width:"100%",float:"left"},attrs:{prop:"execution_policy","label-width":"100px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("span",[t._v(" 执行策略 ")])])]),t._v(" "),a("el-radio-group",{model:{value:t.form.execution_policy,callback:function(e){t.$set(t.form,"execution_policy",e)},expression:"form.execution_policy"}},[a("el-radio-button",{attrs:{label:"loop_execution"}},[t._v(" 循环执行 ")]),t._v(" "),a("el-radio-button",{attrs:{label:"perform"}},[t._v(" 执行一次 ")])],1)],1),t._v(" "),a("el-form-item",{staticStyle:{width:"100%",float:"left"},attrs:{label:"状态"}},[a("el-radio-group",{model:{value:t.form.is_state,callback:function(e){t.$set(t.form,"is_state",e)},expression:"form.is_state"}},t._l(t.addStatusOptions,(function(e){return a("el-radio",{key:e.dictValue,attrs:{label:e.dictValue}},[t._v(t._s(e.dictLabel))])})),1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1),t._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:t.jobsTitle,visible:t.jobsOpen,width:"80%"},on:{"update:visible":function(e){t.jobsOpen=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.jobLogData,stripe:"",height:"250"}},[a("el-table-column",{attrs:{prop:"job_id",align:"center",label:"任务id",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"start_time",label:"开始日期",width:"240"}}),t._v(" "),a("el-table-column",{attrs:{prop:"end_time",label:"结束日期",width:"240"}}),t._v(" "),a("el-table-column",{attrs:{label:"执行状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(1==e.row.is_state?"执行成功":"执行失败"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"err_msg",label:"异常信息"}})],1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.jobLogQuery.total>0,expression:"jobLogQuery.total > 0"}],attrs:{total:t.jobLogQuery.total,page:t.jobLogQuery.page,limit:t.jobLogQuery.page_size},on:{"update:page":function(e){return t.$set(t.jobLogQuery,"page",e)},"update:limit":function(e){return t.$set(t.jobLogQuery,"page_size",e)},pagination:t.getJobsLogList}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)],1)},n=[],i=a("531f"),l=(a("3b6a"),a("8f8b"),{name:"Tab",data:function(){return{loading:!1,ids:[],single:!0,multiple:!0,total:0,tab_list:[],title:"",open:!1,jobsOpen:!1,jobsTitle:"",isEdit:!1,statusOptions:[{dictValue:-1,dictLabel:"全部"},{dictValue:1,dictLabel:"开启"},{dictValue:0,dictLabel:"关闭"}],addStatusOptions:[{dictValue:1,dictLabel:"开启"},{dictValue:0,dictLabel:"关闭"}],queryParams:{page:1,page_size:10,label:"",is_state:-1},form:{id:"",job_name:"",job_group:"",cron_expression:"",invoke_type:"interface",execution_policy:"loop_execution",is_concurrent:0,invoke_target:"",is_state:0,target_parameter:""},jobLogQuery:{id:"",total:1,page:1,page_size:10},jobLogData:[]}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,Object(i["e"])(this.queryParams).then((function(e){t.loading=!1,t.total=e.data.total;t.tab_list=e.data.data}))},cancel:function(){this.open=!1,this.jobsOpen=!1,this.reset()},reset:function(){this.form={id:"",job_name:"",job_group:"",cron_expression:"",invoke_type:"interface",execution_policy:"loop_execution",is_concurrent:0,invoke_target:"",is_state:0,target_parameter:""}},handleQuery:function(){this.queryParams.page=1,this.getList()},resetQuery:function(){this.queryParams.page=1,this.queryParams.page_size=10,this.queryParams.job_name="",this.queryParams.is_state=-1,this.handleQuery()},handleSelectionChange:function(t){this.ids=t.map((function(t){return t.id})),this.single=1!==t.length,this.multiple=!t.length},handleAdd:function(){this.reset(),this.open=!0,this.title="添加任务",this.isEdit=!1,this.form.is_state=1},handleJobLog:function(t){this.jobsTitle=t.job_name,this.jobLogQuery.id=t.id,this.jobLogData=[],this.jobsOpen=!0,this.getJobsLogList()},handleUpdate:function(t){var e=this;this.reset();var a=t.id||this.ids[0];Object(i["e"])({id:a,is_state:-1}).then((function(t){e.form=t.data.data[0],e.open=!0,e.title="修改任务",e.isEdit=!1}))},changeJobExecution:function(t){var e=this,a=t.id||this.ids[0];Object(i["b"])({id:a}).then((function(t){e.responseMessage(t),e.getList()}))},submitForm:function(){var t=this,e="";e=""!=this.form.id?Object(i["h"])(this.form):Object(i["a"])(this.form),e.then((function(e){200==e.code&&(t.open=!1),t.responseMessage(e),t.getList()}))},handleDelete:function(t){var e=t.id||this.ids,a="";void 0!=t.job_name&&(a=": "+t.job_name),this.$confirm("是否确认删除任务"+a+" ?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=this;Object(i["c"])({id:e.join(",")}).then((function(e){200==e.code?t.msgSuccess(e.msg):t.msgError(e.msg)}))})).catch((function(){})),this.getList()},getJobsLogList:function(){var t=this;Object(i["d"])(this.jobLogQuery).then((function(e){t.jobLogData=e.data.data,t.jobLogQuery.total=e.data.total}))}}}),r=l,s=a("2877"),c=Object(s["a"])(r,o,n,!1,null,null,null);e["default"]=c.exports},"8f8b":function(t,e,a){"use strict";a("7f7f"),a("ac6a"),a("d161"),a("5c96"),a("3b6a")},d161:function(t,e,a){"use strict";a.d(e,"h",(function(){return i})),a.d(e,"e",(function(){return l})),a.d(e,"f",(function(){return r})),a.d(e,"c",(function(){return s})),a.d(e,"d",(function(){return c})),a.d(e,"g",(function(){return u})),a.d(e,"a",(function(){return d})),a.d(e,"b",(function(){return p}));var o=a("b775"),n=a("9a6f");function i(t){return Object(o["a"])({url:n["a"].uploadImgs,method:"post",data:t})}function l(t){return Object(o["a"])({url:n["a"].searchImgs,method:"get",params:t})}function r(t){return Object(o["a"])({url:n["a"].mvImgs,method:"put",data:t})}function s(t){return Object(o["a"])({url:n["a"].delImgs,method:"delete",params:t})}function c(t){return Object(o["a"])({url:n["a"].getImgsGroup,method:"get",data:t})}function u(t){return Object(o["a"])({url:n["a"].updateImgsGroup,method:"put",data:t})}function d(t){return Object(o["a"])({url:n["a"].addImgsGroup,method:"post",data:t})}function p(t){return Object(o["a"])({url:n["a"].delImgsGroup,method:"DELETE",data:t})}}}]);